<head>
  <title>New Match</title>
  <style>
    div {
      text-align: center;
      margin: auto;
      width: 500px;
    }

    table {
      margin: 0 auto;
    }

    .pbp {
      white-space: pre-wrap;
    }

    .score {
      font-size: 1.2em;
    }
  </style>
</head>

<body>
  <div class="score">Score</div>
  <div class="Players">
    <span class="PlayerA">Player A</span>
    <span class="PlayerB">Player Ca</span>
  </div>
  <div class="date"> Date</div>
  <div class="server">Serving:</div>
  <div class="progress">
    <progress value="0.5" max="1"></progress>
  </div>
  <hr>
  <div class="pointq">Was the first serve in?</div>
  <div class="radio">
    <input type="radio" name="serveIn" value="servein"> Yes
    <input type="radio" name="serveIn" value="serveout"> No
  </div>
  <div class="pointq">Who won the point?</div>
  <div class="radio">
    <input type="radio" name="whowon" value="Awon"> Player A
    <input type="radio" name="whowon" value="Bwon"> Player B
  </div>
  <div class="pointq">Who came to the net?</div>
  <div class="checkboxes">
    <input type="checkbox" name="whocame" value="Acame"> Player A
    <input type="checkbox" name="whocame" value="Bcame"> Player B
  </div>
  <div class="pointq">How was the point won?</div>
  <div class="radio">
    <input type="radio" name="howwon" value="ace"> Ace
    <input type="radio" name="howwon" value="swinner"> Service Winner
    <input type="radio" name="howwon" value="df"> Double Fault
  </div>
  <div class="radio">
    <input type="radio" name="howwon" value="fhw"> FH Winner
    <input type="radio" name="howwon" value="bhw"> BH Winner
    <input type="radio" name="howwon" value="fhe"> FH Error
    <input type="radio" name="howwon" value="bhe"> BH Error
  </div>
  <div class="radio">
    <input type="radio" name="howwon" value="nw"> Net Winner
    <input type="radio" name="howwon" value="ne"> Net Error
  </div>
  <div class="button">
    <button type="button" class="submitb" onclick="increment()">Submit Point</button>
    <button type="button" class="resetb"
      onclick="if (confirm('Are you sure you want to reload?')) { location.reload(); }">Reset Match</button>
  </div>
  <hr>
  <div class="Players">
    <span class="PlayerA">Player A</span>
    <span class="PlayerB">Player B</span>
  </div>
  <div class="Ratings">
    <span class="RatingA">Player A</span>
    <span class="RatingB">Player B</span>
  </div>
  <div class="Button Menu">
    <button type="button" class="bmenubutton" onclick="overviewbf()">Overview</button>
    <button type="button" class="bmenubutton" onclick="servingbf()">Serving</button>
    <button type="button" class="bmenubutton" onclick="returnbf()">Returning</button>
    <button type="button" class="bmenubutton" onclick="wenbf()">W/E & Net</button>
    <button type="button" class="bmenubutton" onclick="adfbf()">Aces/DF</button>
    <button type="button" class="bmenubutton" onclick="totalbf()">Total</button>
  </div>
  <div class="btt">Serve</div>
  <div>
    <table>
      <tr class="table-row">
        <td class="tl1">0</td>
        <td class="tm1">Aces</td>
        <td class="tr1">0</td>
      </tr>
      <tr class="table-row">
        <td class="tl2">0</td>
        <td class="tm2">Double Faults</td>
        <td class="tr2">0</td>
      </tr>
      <tr class="table-row">
        <td class="tl3">-</td>
        <td class="tm3">1st Serve %</td>
        <td class="tr3">-</td>
      </tr>
      <tr class="table-row">
        <td class="tl4">-</td>
        <td class="tm4">1st Serve Won %</td>
        <td class="tr4">-</td>
      </tr>
      <tr class="table-row">
        <td class="tl5">-</td>
        <td class="tm5">2nd Serve Won %</td>
        <td class="tr5">-</td>
      </tr>
      <tr class="table-row">
        <td class="tl6">-</td>
        <td class="tm6">Break Points</td>
        <td class="tr6">-</td>
      </tr>
      <tr class="table-row">
        <td class="tl7">-</td>
        <td class="tm7">Service Points Won %</td>
        <td class="tr7">-</td>
      </tr>

    </table>
  </div>
  <div class="btm">Return</div>
  <div>
    <table>
      <tr class="table-row">
        <td class="ml1">-</td>
        <td class="mm1">1st Serve Return Won %</td>
        <td class="mr1">-</td>
      </tr>
      <tr class="table-row">
        <td class="ml2">-</td>
        <td class="mm2">2nd Serve Return Won %</td>
        <td class="mr2">-</td>
      </tr>
      <tr class="table-row">
        <td class="ml3">-</td>
        <td class="mm3">Return Points Won %</td>
        <td class="mr3">-</td>
      </tr>
      <tr class="table-row">
        <td class="ml4"></td>
        <td class="mm4"></td>
        <td class="mr4"></td>
      </tr>
      <tr class="table-row">
        <td class="ml5"></td>
        <td class="mm5"></td>
        <td class="mr5"></td>
      </tr>
      <tr class="table-row">
        <td class="ml6"></td>
        <td class="mm6"></td>
        <td class="mr6"></td>
      </tr>
      <tr class="table-row">
        <td class="ml7"></td>
        <td class="mm7"></td>
        <td class="mr7"></td>
      </tr>

    </table>
  </div>
  <div class="btb">Total</div>
  <div>
    <table>
      <tr class="table-row">
        <td class="bl1">-</td>
        <td class="bm1">Point Dominance</td>
        <td class="br1">-</td>
      </tr>
      <tr class="table-row">
        <td class="bl2">0</td>
        <td class="bm2">Total Points Won</td>
        <td class="br2">0</td>
      </tr>
      <tr class="table-row">
        <td class="bl3">0:00</td>
        <td class="bm3">Match Time</td>
        <td class="br3">0:00</td>
      </tr>
      <tr class="table-row">
        <td class="bl4"></td>
        <td class="bm4"></td>
        <td class="br4"></td>
      </tr>
      <tr class="table-row">
        <td class="bl5"></td>
        <td class="bm5"></td>
        <td class="br5"></td>
      </tr>
    </table>
  </div>
  <hr>
  <div>Play-by-Play</div>
  <div class="pbp"></div>

  <script>
    class Player {
      constructor(name) {
        this.name = name;
        this.aces = 0;
        this.pointsWon = 0;
        this.gamesWon = 0;
        this.dfs = 0;
        this.firstServePoints = 0;
        this.firstServePointsWon = 0;
        this.secondServePoints = 0;
        this.secondServePointsWon = 0;
        this.netPoints = 0;
        this.netPointsWon = 0;
        this.breakPoints = 0;
        this.breaks = 0;

      }
      getPointsWon() {
        return this.pointsWon;
      }

      getGamesWon() {
        return this.gamesWon;
      }
      getPointsServed() {
        return this.firstServePoints + this.secondServePoints;
      }
      getServicePointsWon() {
        return this.firstServePointsWon + this.secondServePointsWon;
      }
      getFirstServePoints() {
        return this.firstServePoints;
      }

      getSecondServePoints() {
        return this.secondServePoints;
      }

      getFirstServePointsWon() {
        return this.firstServePointsWon;
      }

      getSecondServePointsWon() {
        return this.secondServePointsWon;
      }
      getDoubleFaults() {
        return this.dfs;
      }

      getAces() {
        return this.aces;
      }
      getBreakPoints() {
        return this.breakPoints;
      }

      getBreakPointsWon() {
        return this.breaks;
      }
      getNetPoints() {
        return this.netPoints;
      }

      getNetPointsWon() {
        return this.netPointsWon;
      }

      inc(stat) {
        switch (stat) {
          case "Games": this.gamesWon++; break;
          case "Points": this.pointsWon++; break;
          case "First Serve Points": this.firstServePoints++; break;
          case "Second Serve Points": this.secondServePoints++; break;
          case "First Serve Points Won": this.firstServePointsWon++; break;
          case "Second Serve Points Won": this.secondServePointsWon++; break;
          case "Net Points": this.netPoints++; break;
          case "Net Points Won": this.netPointsWon++; break;
          case "Break Points": this.breakPoints++; break;
          case "Break Points Won": this.breaks++; break;
          case "Aces": this.aces++; break;
          case "Double Faults": this.dfs++; break;
        }
      }
    }

    class Match {
      constructor(player1, player2) {
        this.players = [player1, player2];
      }
      getTotalPoints() {
        return this.players[0].pointsWon + this.players[1].pointsWon;
      }
      getTotalGames() {
        return this.players[0].gamesWon + this.players[1].gamesWon;
      }


    }
    let PlayerA = new Player("Player A");
    let PlayerB = new Player("Player B");
    let match = new Match(PlayerA, PlayerB);



    var apts = 0;
    var bpts = 0;
    var agames = 0;
    var bgames = 0;
    var asets = 0;
    var bsets = 0;
    let prevSets = [];
    let gameScores = [0, 15, 30, 40];
    const score = document.querySelector('.score')
    score.textContent = apts + '-' + bpts;

    var statmode = 'Overview'

    var match_done = false;
    var tiebreak = 0;
    var server = "Player A";
    var tbserver = '';
    var divserver = document.querySelector(".server");
    divserver.textContent = "Serving: " + server;
    var startTime = new Date();



    const dateDiv = document.querySelector('.date');
    dateDiv.textContent = dateDiv.textContent = new Intl.DateTimeFormat('en-US', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      weekday: 'long'
    }).format(new Date());


    function changeTitles(top, mid, bot) {
      const thead = document.querySelector('.btt');
      thead.textContent = top;
      const mhead = document.querySelector('.btm');
      mhead.textContent = mid;
      const bhead = document.querySelector('.btb');
      bhead.textContent = bot;
    }

    function formatTotalTime(t) {
      let hours = Math.floor(t / 3600000);
      let minutes = Math.floor((t - (hours * 3600000)) / 60000);
      return hours + ':' + (minutes < 10 ? '0' + minutes : minutes);
    }

    function toggleServer() {
      var divserver = document.querySelector(".server");

      if (divserver.textContent === "Serving: Player A") {
        divserver.textContent = "Serving: Player B";
        server = "Player B"
      } else {
        divserver.textContent = "Serving: Player A";
        server = "Player A"
      }
    }
    function changeValue(code, lef, mid, rig) {
      const left = document.querySelector('.' + code[0] + 'l' + code[1])
      left.textContent = lef

      const middle = document.querySelector('.' + code[0] + 'm' + code[1])
      middle.textContent = mid

      const right = document.querySelector('.' + code[0] + 'r' + code[1])
      right.textContent = rig
    }

    function isBreakPoint(server, playerAPoints, playerBPoints) {
      // If player A is serving
      if (server === 'A') {
        // It's a break point if:
        // - Player B has 40 points and player A has 30 points
        // - Player B has advantage (ad) 
        if ((playerBPoints === 40 && playerAPoints === 30) || playerBPoints === 'ad') {
          return true;
        }
      }
      // If player B is serving
      else if (server === 'B') {
        // It's a break point if: 
        // - Player A has 40 points and player B has 30 points
        // - Player A has advantage (ad)
        if ((playerAPoints === 40 && playerBPoints === 30) || playerAPoints === 'ad') {
          return true;
        }
      }
      return false;
    }

    function totalbfbottom() {
      var eTime = new Date() - startTime;
      var pointTime = match.getTotalPoints() === 0 ? '-' : ((eTime / 1000) / match.getTotalPoints()).toFixed(1)
      changeValue('b1', pointTime, 'Avg. Point Time (Sec)', pointTime)
      changeValue('b2', '', 'Avg. Game Time (min)', '')
      changeValue('b3', '', 'Avg. Service Game Time (min)', '')
      changeValue('b4', '', 'Avg. Set Time (min)', '')
      changeValue('b5', formatTotalTime(eTime), 'Match Time', formatTotalTime(eTime))


    }
    function totalbfmiddle() {
      changeValue('m1', match.getTotalGames(), 'Games Played', match.getTotalGames())
      changeValue('m2', PlayerA.getGamesWon(), 'Games Won', PlayerB.getGamesWon())
      changeValue('m4', '', '', '')
      changeValue('m5', '', '', '')
      changeValue('m6', '', '', '')
      changeValue('m7', '', '', '')

      const ml3 = document.querySelector('.ml3');
      ml3.textContent = (match.getTotalGames() === 0) ? '-' : (100 * PlayerA.getGamesWon() / (match.getTotalGames())).toFixed(2)
      const mm3 = document.querySelector('.mm3');
      mm3.textContent = 'Games Won %'
      const mr3 = document.querySelector('.mr3');
      mr3.textContent = (match.getTotalGames() === 0) ? '-' : (100 * PlayerB.getGamesWon() / (match.getTotalGames())).toFixed(2)
    }
    function totalbf() {
      statmode = 'Total'
      changeTitles('Points', 'Games', 'Time')

      const tl1 = document.querySelector('.tl1');
      tl1.textContent = match.getTotalPoints()
      const tm1 = document.querySelector('.tm1');
      tm1.textContent = 'Points Played'
      const tr1 = document.querySelector('.tr1');
      tr1.textContent = match.getTotalPoints()
      const tl2 = document.querySelector('.tl2');
      tl2.textContent = PlayerA.getPointsWon()
      const tm2 = document.querySelector('.tm2');
      tm2.textContent = 'Points Won'
      const tr2 = document.querySelector('.tr2');
      tr2.textContent = PlayerB.getPointsWon()
      const tl3 = document.querySelector('.tl3');
      tl3.textContent = (match.getTotalPoints() === 0) ? '-' : (100 * PlayerA.getPointsWon() / match.getTotalPoints()).toFixed(2)
      const tm3 = document.querySelector('.tm3');
      tm3.textContent = 'Points Won %'
      const tr3 = document.querySelector('.tr3');
      tr3.textContent = (match.getTotalPoints() === 0) ? '-' : (100 * PlayerB.getPointsWon() / (match.getTotalPoints())).toFixed(2)
      const tl4 = document.querySelector('.tl4');
      tl4.textContent = (PlayerA.getPointsServed() === 0 || PlayerB.getPointsServed() === 0) ? '-' : (PlayerB.getPointsServed() / PlayerA.getPointsServed()).toFixed(2)
      const tm4 = document.querySelector('.tm4');
      tm4.textContent = 'Rtn. to Svc. Points Ratio'
      const tr4 = document.querySelector('.tr4');
      tr4.textContent = (PlayerA.getPointsServed() === 0 || PlayerB.getPointsServed() === 0) ? '-' : (PlayerA.getPointsServed() / PlayerB.getPointsServed()).toFixed(2)

      changeValue('t5', '', '', '')
      changeValue('t6', '', '', '')
      changeValue('t7', '', '', '')
      totalbfbottom()
      totalbfmiddle()

    }
    function overviewbfbottom() {
      var eTime = new Date() - startTime;
      var apd = (PlayerA.getPointsServed() === 0 || PlayerB.getPointsServed() === 0) ? '-' : ((1 - ((PlayerB.getServicePointsWon()) / (PlayerB.getPointsServed()))) / (1 - ((PlayerA.getServicePointsWon()) / (PlayerA.getPointsServed())))).toFixed(2)
      var bpd = (PlayerA.getPointsServed() === 0 || PlayerB.getPointsServed() === 0) ? '-' : ((1 - ((PlayerA.getServicePointsWon()) / PlayerA.getPointsServed())) / (1 - (PlayerB.getServicePointsWon() / PlayerB.getPointsServed()))).toFixed(2)
      changeValue('b1', apd, 'Points Dominance', bpd)
      changeValue('b2', PlayerA.getPointsWon(), 'Total Points Won', PlayerB.getPointsWon())
      changeValue('b3', formatTotalTime(eTime), 'Match Time', formatTotalTime(eTime))
      changeValue('b4', '', '', '')
      changeValue('b5', '', '', '')

    }
    function overviewbfmiddle() {

      changeValue('m4', '', '', '')
      changeValue('m5', '', '', '')
      changeValue('m6', '', '', '')
      changeValue('m7', '', '', '')


      const ml3 = document.querySelector('.ml3');
      ml3.textContent = (PlayerB.getPointsServed() === 0) ? '-' : (100 - (100 * (PlayerB.getServicePointsWon()) / (PlayerB.getPointsServed()))).toFixed(2)
      const mm3 = document.querySelector('.mm3');
      mm3.textContent = 'Return Points Won %'
      const mr3 = document.querySelector('.mr3');
      mr3.textContent = (PlayerA.getPointsServed() === 0) ? '-' : (100 - (100 * PlayerA.getServicePointsWon() / PlayerA.getPointsServed())).toFixed(2)
      const ml2 = document.querySelector('.ml2');
      ml2.textContent = (PlayerB.getSecondServePoints() === 0) ? '-' : (100 - (100 * PlayerB.getSecondServePointsWon() / PlayerB.getSecondServePoints())).toFixed(2)
      const mm2 = document.querySelector('.mm2');
      mm2.textContent = '2nd Serve Return Won %'
      const mr2 = document.querySelector('.mr2');
      mr2.textContent = (PlayerA.getSecondServePoints() === 0) ? '-' : (100 - (100 * PlayerA.getSecondServePointsWon() / PlayerA.getSecondServePoints())).toFixed(2)
      const ml1 = document.querySelector('.ml1');
      ml1.textContent = (PlayerB.getFirstServePoints() === 0) ? '-' : (100 - (100 * PlayerB.getFirstServePointsWon() / PlayerB.getFirstServePoints())).toFixed(2)
      const mm1 = document.querySelector('.mm1');
      mm1.textContent = '1st Serve Return Won %'
      const mr1 = document.querySelector('.mr1');
      mr1.textContent = (PlayerA.getFirstServePoints() === 0) ? '-' : (100 - (100 * PlayerA.getFirstServePointsWon() / PlayerA.getFirstServePoints())).toFixed(2)

    }
    function overviewtopbf() {
      changeValue('t1', PlayerA.getAces(), 'Aces', PlayerB.getAces())
      changeValue('t2', PlayerA.getDoubleFaults(), 'Double Faults', PlayerB.getDoubleFaults())


      const tl3 = document.querySelector('.tl3');
      tl3.textContent = ((PlayerA.getPointsServed()) === 0) ? '-' : (100 * PlayerA.getFirstServePoints() / PlayerA.getPointsServed()).toFixed(2)
      const tm3 = document.querySelector('.tm3');
      tm3.textContent = '1st Serve %'
      const tr3 = document.querySelector('.tr3');
      tr3.textContent = ((PlayerB.getPointsServed()) === 0) ? '-' : (100 * PlayerB.getFirstServePoints() / PlayerB.getPointsServed()).toFixed(2)
      const tl4 = document.querySelector('.tl4');
      tl4.textContent = (PlayerA.getFirstServePoints() === 0) ? '-' : (100 * PlayerA.getFirstServePointsWon() / PlayerA.getFirstServePoints()).toFixed(2)
      const tm4 = document.querySelector('.tm4');
      tm4.textContent = '1st Serve Won %'
      const tr4 = document.querySelector('.tr4');
      tr4.textContent = (PlayerB.getFirstServePoints() === 0) ? '-' : (100 * PlayerB.getFirstServePointsWon() / PlayerB.getFirstServePoints()).toFixed(2)
      const tl5 = document.querySelector('.tl5');
      tl5.textContent = (PlayerA.getSecondServePoints() === 0) ? '-' : (100 * PlayerA.getSecondServePointsWon() / PlayerA.getSecondServePoints()).toFixed(2)
      const tm5 = document.querySelector('.tm5');
      tm5.textContent = '2nd Serve Won %'
      const tr5 = document.querySelector('.tr5');
      tr5.textContent = (PlayerB.getSecondServePoints() === 0) ? '-' : (100 * PlayerB.getSecondServePointsWon() / PlayerB.getSecondServePoints()).toFixed(2)

      const tl6 = document.querySelector('.tl6');
      tl6.textContent = PlayerA.getBreakPointsWon() + "/" + PlayerA.getBreakPoints()
      const tm6 = document.querySelector('.tm6');
      tm6.textContent = 'Break Points'
      const tr6 = document.querySelector('.tr6');
      tr6.textContent = PlayerB.getBreakPointsWon() + "/" + PlayerB.getBreakPoints()


      const tl7 = document.querySelector('.tl7');
      tl7.textContent = (PlayerA.getPointsServed() === 0) ? '-' : (100 * PlayerA.getServicePointsWon() / PlayerA.getPointsServed()).toFixed(2)
      const tm7 = document.querySelector('.tm7');
      tm7.textContent = 'Service Points Won %'
      const tr7 = document.querySelector('.tr7');
      tr7.textContent = (PlayerB.getPointsServed() === 0) ? '-' : (100 * PlayerB.getServicePointsWon() / PlayerB.getPointsServed()).toFixed(2)

      overviewbfmiddle()
    }
    function overviewbf() {
      changeTitles('Serve', 'Return', 'Total')

      statmode = 'Overview'
      overviewtopbf()

      overviewbfbottom()


    }

    function servingbfbottom() {
      changeValue('b1', '', 'Service Games Won %', '')
      changeValue('b2', '', 'Service Games Lost per Set', '')
      changeValue('b3', '', '', '')
      changeValue('b4', '', '', '')
      changeValue('b5', '', '', '')

    }

    function servingbfmiddle() {
      const ml5 = document.querySelector('.ml5');
      ml5.textContent = ''
      const mm5 = document.querySelector('.mm5');
      mm5.textContent = 'Break Points'
      const mr5 = document.querySelector('.mr5');
      mr5.textContent = ''
      const ml4 = document.querySelector('.ml4');
      ml4.textContent = ''
      const mm4 = document.querySelector('.mm4');
      mm4.textContent = 'Points Lost per Service Game'
      const mr4 = document.querySelector('.mr4');
      mr4.textContent = ''
      const ml3 = document.querySelector('.ml3');
      ml3.textContent = ''
      const mm3 = document.querySelector('.mm3');
      mm3.textContent = 'Points Per Service Game'
      const mr3 = document.querySelector('.mr3');
      mr3.textContent = ''
      const ml2 = document.querySelector('.ml2');
      ml2.textContent = ''
      const mm2 = document.querySelector('.mm2');
      mm2.textContent = 'Service In-Play Points Won'
      const mr2 = document.querySelector('.mr2');
      mr2.textContent = ''
      const ml1 = document.querySelector('.ml1');
      ml1.textContent = (PlayerA.getPointsServed() === 0) ? '-' : (100 * (PlayerA.getServicePointsWon()) / PlayerA.getPointsServed()).toFixed(2)
      const mm1 = document.querySelector('.mm1');
      mm1.textContent = 'Service Points Won %'
      const mr1 = document.querySelector('.mr1');
      mr1.textContent = (PlayerB.getPointsServed() === 0) ? '-' : (100 * (PlayerB.getServicePointsWon()) / PlayerB.getPointsServed()).toFixed(2)
      const ml6 = document.querySelector('.ml6');
      ml6.textContent = ''
      const mm6 = document.querySelector('.mm6');
      mm6.textContent = 'BPs Faced per Service Game'
      const mr6 = document.querySelector('.mr6');
      mr6.textContent = ''
      const ml7 = document.querySelector('.ml7');
      ml7.textContent = ''
      const mm7 = document.querySelector('.mm7');
      mm7.textContent = 'BPs Faced per Set'
      const mr7 = document.querySelector('.mr7');
      mr7.textContent = ''

    }
    function servingbftop() {
      const tl1 = document.querySelector('.tl1');
      tl1.textContent = (PlayerA.getPointsServed() === 0) ? '-' : (100 * PlayerA.getFirstServePoints() / PlayerA.getPointsServed()).toFixed(2)
      const tm1 = document.querySelector('.tm1');
      tm1.textContent = '1st Serve %'
      const tr1 = document.querySelector('.tr1');
      tr1.textContent = (PlayerB.getPointsServed() === 0) ? '-' : (100 * PlayerB.getFirstServePoints() / PlayerB.getPointsServed()).toFixed(2)
      const tl2 = document.querySelector('.tl2');
      tl2.textContent = (PlayerA.getSecondServePoints() === 0) ? '-' : (100 * (1 - PlayerA.getDoubleFaults() / PlayerA.getSecondServePoints())).toFixed(2)
      const tm2 = document.querySelector('.tm2');
      tm2.textContent = '2nd Serve %'
      const tr2 = document.querySelector('.tr2');
      tr2.textContent = (PlayerB.getSecondServePoints() === 0) ? '-' : (100 * (1 - PlayerB.getDoubleFaults() / PlayerB.getSecondServePoints())).toFixed(2)
      const tl3 = document.querySelector('.tl3');
      tl3.textContent = (PlayerA.getFirstServePoints() === 0) ? '-' : (100 * PlayerA.getFirstServePointsWon() / PlayerA.getFirstServePoints()).toFixed(2)
      const tm3 = document.querySelector('.tm3');
      tm3.textContent = '1st Serve Won %'
      const tr3 = document.querySelector('.tr3');
      tr3.textContent = (PlayerB.getFirstServePoints() === 0) ? '-' : (100 * PlayerB.getFirstServePointsWon() / PlayerB.getFirstServePoints()).toFixed(2)
      const tl4 = document.querySelector('.tl4');
      tl4.textContent = (PlayerA.getSecondServePoints() === 0) ? '-' : (100 * PlayerA.getSecondServePointsWon() / PlayerA.getSecondServePoints()).toFixed(2)
      const tm4 = document.querySelector('.tm4');
      tm4.textContent = '2nd Serve Won %'
      const tr4 = document.querySelector('.tr4');
      tr4.textContent = (PlayerAB.getSecondServePoints() === 0) ? '-' : (100 * PlayerB.getSecondServePointsWon() / PlayerB.getSecondServePoints()).toFixed(2)
      const tl5 = document.querySelector('.tl5');
      tl5.textContent = ''
      const tm5 = document.querySelector('.tm5');
      tm5.textContent = '1st Serve Reliance'
      const tr5 = document.querySelector('.tr5');
      tr5.textContent = ''
      const tl6 = document.querySelector('.tl6');
      tl6.textContent = ''
      const tm6 = document.querySelector('.tm6');
      tm6.textContent = 'Serve Rating'
      const tr6 = document.querySelector('.tr6');
      tr6.textContent = ''
      changeValue('t7', '', '', '')

      servingbfmiddle()
    }

    function servingbf() {
      servingbfbottom()
      statmode = 'Serving'
      changeTitles('Serve', 'Points', 'Games')
      servingbftop()
    }

    function returnbfbottom() {
      changeValue('b3', '', '', '')
      changeValue('b4', '', '', '')
      changeValue('b5', '', '', '')

      const bl2 = document.querySelector('.bl2');
      bl2.textContent = ''
      const bm2 = document.querySelector('.bm2');
      bm2.textContent = 'Return Games Won per Set'
      const br2 = document.querySelector('.br2');
      br2.textContent = ''
      const bl1 = document.querySelector('.bl1');
      bl1.textContent = ''
      const bm1 = document.querySelector('.bm1');
      bm1.textContent = 'Return Games Won %'
      const br1 = document.querySelector('.br1');
      br1.textContent = ''
    }

    function returnbfmiddle() {
      const ml5 = document.querySelector('.ml5');
      ml5.textContent = ''
      const mm5 = document.querySelector('.mm5');
      mm5.textContent = 'Break Points'
      const mr5 = document.querySelector('.mr5');
      mr5.textContent = ''
      const ml4 = document.querySelector('.ml4');
      ml4.textContent = ''
      const mm4 = document.querySelector('.mm4');
      mm4.textContent = 'Points Won per Return Game'
      const mr4 = document.querySelector('.mr4');
      mr4.textContent = ''
      const ml3 = document.querySelector('.ml3');
      ml3.textContent = ''
      const mm3 = document.querySelector('.mm3');
      mm3.textContent = 'Points Per Return Game'
      const mr3 = document.querySelector('.mr3');
      mr3.textContent = ''
      const ml2 = document.querySelector('.ml2');
      ml2.textContent = ''
      const mm2 = document.querySelector('.mm2');
      mm2.textContent = 'Return In-Play Points Won'
      const mr2 = document.querySelector('.mr2');
      mr2.textContent = ''
      const ml1 = document.querySelector('.ml1');
      ml1.textContent = (PlayerB.getPointsServed() === 0) ? '-' : (100 - (100 * (PlayerB.getServicePointsWon()) / (PlayerB.getPointsServed()))).toFixed(2)
      const mm1 = document.querySelector('.mm1');
      mm1.textContent = 'Return Points Won %'
      const mr1 = document.querySelector('.mr1');
      mr1.textContent = ((PlayerA.getPointsServed()) === 0) ? '-' : (100 - (100 * (PlayerA.getServicePointsWon()) / (PlayerA.getPointsServed()))).toFixed(2)
      const ml6 = document.querySelector('.ml6');
      ml6.textContent = ''
      const mm6 = document.querySelector('.mm6');
      mm6.textContent = 'BPs per Return Game'
      const mr6 = document.querySelector('.mr6');
      mr6.textContent = ''
      const ml7 = document.querySelector('.ml7');
      ml7.textContent = ''
      const mm7 = document.querySelector('.mm7');
      mm7.textContent = 'BPs per Set'
      const mr7 = document.querySelector('.mr7');
      mr7.textContent = ''
    }

    function returnbftop() {
      const tl1 = document.querySelector('.tl1');
      tl1.textContent = (PlayerB.getFirstServePoints() === 0) ? '-' : (100 - (100 * PlayerB.getFirstServePointsWon() / PlayerB.getFirstServePoints())).toFixed(2)
      const tm1 = document.querySelector('.tm1');
      tm1.textContent = '1st Serve Return Won %'
      const tr1 = document.querySelector('.tr1');
      tr1.textContent = (PlayerA.getFirstServePoints() === 0) ? '-' : (100 - (100 * PlayerA.getFirstServePointsWon() / PlayerA.getFirstServePoints())).toFixed(2)
      const tl2 = document.querySelector('.tl2');
      tl2.textContent = ''
      const tm2 = document.querySelector('.tm2');
      tm2.textContent = '2nd Serve Return Won %'
      const tr2 = document.querySelector('.tr2');
      tr2.textContent = ''
      const tl3 = document.querySelector('.tl3');
      tl3.textContent = ''
      const tm3 = document.querySelector('.tm3');
      tm3.textContent = 'Return Rating'
      const tr3 = document.querySelector('.tr3');
      tr3.textContent = ''
      changeValue('t4', '', '', '')
      changeValue('t5', '', '', '')
      changeValue('t6', '', '', '')
      changeValue('t7', '', '', '')

      returnbfmiddle()
    }

    function returnbf() {
      statmode = 'Returning'
      changeTitles("Return", "Points", "Games")
      returnbfbottom()
      returnbftop()

    }
    function wenbfbottom() {
      changeValue('b4', '', '', '')
      changeValue('b5', '', '', '')

      const bl3 = document.querySelector('.bl3');
      bl3.textContent = ''
      const bm3 = document.querySelector('.bm3');
      bm3.textContent = 'Dominance Ratio'
      const br3 = document.querySelector('.br3');
      br3.textContent = ''
      const bl2 = document.querySelector('.bl2');
      bl2.textContent = ''
      const bm2 = document.querySelector('.bm2');
      bm2.textContent = 'Game Dominance'
      const br2 = document.querySelector('.br2');
      br2.textContent = ''
      const bl1 = document.querySelector('.bl1');
      bl1.textContent = ''
      const bm1 = document.querySelector('.bm1');
      bm1.textContent = 'Points Dominance'
      const br1 = document.querySelector('.br1');
      br1.textContent = ''
    }
    function wenbfmiddle() {
      changeValue('m5', '', '', '')
      changeValue('m6', '', '', '')
      changeValue('m7', '', '', '')

      const ml4 = document.querySelector('.ml4');
      ml4.textContent = ''
      const mm4 = document.querySelector('.mm4');
      mm4.textContent = 'Net Effectiveness'
      const mr4 = document.querySelector('.mr4');
      mr4.textContent = ''
      const ml3 = document.querySelector('.ml3');
      ml3.textContent = (PlayerA.getPointsWon() === 0) ? '-' : (PlayerA.getNetPointsWon() / PlayerA.getPointsWon()).toFixed(2)
      const mm3 = document.querySelector('.mm3');
      mm3.textContent = 'Points Won at Net %'
      const mr3 = document.querySelector('.mr3');
      mr3.textContent = (PlayerB.getPointsWon() === 0) ? '-' : (PlayerB.getNetPointsWon() / PlayerB.getPointsWon()).toFixed(2)
      const ml2 = document.querySelector('.ml2');
      ml2.textContent = (PlayerA.getNetPoints() === 0) ? '-' : (PlayerA.getNetPointsWon() / PlayerA.getNetPoints()).toFixed(2)
      const mm2 = document.querySelector('.mm2');
      mm2.textContent = 'Net Points Won %'
      const mr2 = document.querySelector('.mr2');
      mr2.textContent = (PlayerB.getNetPoints() === 0) ? '-' : (PlayerB.getNetPointsWon() / PlayerB.getNetPoints()).toFixed(2)
      const ml1 = document.querySelector('.ml1');
      ml1.textContent = (match.getTotalPoints() === 0) ? '-' : (PlayerA.getNetPoints() / match.getTotalPoints()).toFixed(2)
      const mm1 = document.querySelector('.mm1');
      mm1.textContent = 'Net Points %'
      const mr1 = document.querySelector('.mr1');
      mr1.textContent = (match.getTotalPoints() === 0) ? '-' : (PlayerB.getNetPoints() / match.getTotalPoints()).toFixed(2)

    }

    function wenbftop() {
      const tl1 = document.querySelector('.tl1');
      tl1.textContent = ''
      const tm1 = document.querySelector('.tm1');
      tm1.textContent = 'Winner %'
      const tr1 = document.querySelector('.tr1');
      tr1.textContent = ''
      const tl2 = document.querySelector('.tl2');
      tl2.textContent = ''
      const tm2 = document.querySelector('.tm2');
      tm2.textContent = 'Error %'
      const tr2 = document.querySelector('.tr2');
      tr2.textContent = ''
      const tl3 = document.querySelector('.tl3');
      tl3.textContent = ''
      const tm3 = document.querySelector('.tm3');
      tm3.textContent = 'Winners per Error'
      const tr3 = document.querySelector('.tr3');
      tr3.textContent = ''
      const tl4 = document.querySelector('.tl4');
      tl4.textContent = ''
      const tm4 = document.querySelector('.tm4');
      tm4.textContent = 'Winners per Opp. Error'
      const tr4 = document.querySelector('.tr4');
      tr4.textContent = ''

      changeValue('t5', '', '', '')
      changeValue('t6', '', '', '')
      changeValue('t7', '', '', '')
      wenbfmiddle()
    }
    function wenbf() {
      statmode = 'Wen'
      changeTitles('Winners & Errors', 'Net', "Dominance")
      wenbfbottom()
      wenbftop()


    }

    function adfbfbottom() {
      changeValue('b2', '', '', '')
      changeValue('b3', '', '', '')
      changeValue('b4', '', '', '')
      changeValue('b5', '', '', '')

      const bl1 = document.querySelector('.bl1');
      bl1.textContent = (PlayerA.getAces() + PlayerA.getDoubleFaults()) === 0 ? '-' : ((PlayerA.getDoubleFaults() === 0) ? "inf" : (PlayerA.getAces() / (PlayerA.getDoubleFaults())).toFixed(2))
      const bm1 = document.querySelector('.bm1');
      bm1.textContent = 'Ace/DF Ratio'
      const br1 = document.querySelector('.br1');
      br1.textContent = (PlayerB.getAces() + PlayerB.getDoubleFaults()) === 0 ? '-' : ((PlayerB.getDoubleFaults() === 0) ? "inf" : (PlayerB.getAces() / PlayerB.getDoubleFaults()).toFixed(2))
    }

    function adfbfmiddle() {
      const ml5 = document.querySelector('.ml5');
      ml5.textContent = ''
      const mm5 = document.querySelector('.mm5');
      mm5.textContent = 'DFs per Set'
      const mr5 = document.querySelector('.mr5');
      mr5.textContent = ''
      const ml4 = document.querySelector('.ml4');
      ml4.textContent = ''
      const mm4 = document.querySelector('.mm4');
      mm4.textContent = 'DFs per Service Game'
      const mr4 = document.querySelector('.mr4');
      mr4.textContent = ''
      const ml3 = document.querySelector('.ml3');
      ml3.textContent = (PlayerA.secondServePoints()) === 0 ? '-' : (PlayerA.getDoubleFaults() / PlayerA.getSecondServePoints()).toFixed(2)
      const mm3 = document.querySelector('.mm3');
      mm3.textContent = 'DFs per 2nd Serve'
      const mr3 = document.querySelector('.mr3');
      mr3.textContent = (PlayerB.secondServePoints()) === 0 ? '-' : (PlayerB.getDoubleFaults() / PlayerB.getSecondServePoints()).toFixed(2)
      const ml2 = document.querySelector('.ml2');
      ml2.textContent = PlayerA.getPointsServed() === 0 ? '-' : (100 * PlayerA.getDoubleFaults() / PlayerA.getPointsServed()).toFixed(2)
      const mm2 = document.querySelector('.mm2');
      mm2.textContent = 'Double Fault %'
      const mr2 = document.querySelector('.mr2');
      mr2.textContent = PlayerB.getPointsServed() === 0 ? '-' : (100 * PlayerB.getDoubleFaults() / PlayerB.getPointsServed()).toFixed(2)
      const ml1 = document.querySelector('.ml1');
      ml1.textContent = PlayerA.getDoubleFaults()
      const mm1 = document.querySelector('.mm1');
      mm1.textContent = 'Double Faults'
      const mr1 = document.querySelector('.mr1');
      mr1.textContent = PlayerB.getDoubleFaults()

      changeValue('m6', '', '', '')
      changeValue('m7', '', '', '')
    }

    function adfbftop() {
      const tl1 = document.querySelector('.tl1');
      tl1.textContent = PlayerA.getAces()
      const tm1 = document.querySelector('.tm1');
      tm1.textContent = 'Aces'
      const tr1 = document.querySelector('.tr1');
      tr1.textContent = PlayerB.getAces()
      const tl2 = document.querySelector('.tl2');
      tl2.textContent = (PlayerA.getPointsServed()) === 0 ? '-' : (100 * PlayerA.getAces() / PlayerA.getPointsServed()).toFixed(2)
      const tm2 = document.querySelector('.tm2');
      tm2.textContent = 'Ace %'
      const tr2 = document.querySelector('.tr2');
      tr2.textContent = (PlayerB.getPointsServed()) === 0 ? '-' : (100 * PlayerB.getAces() / PlayerB.getPointsServed()).toFixed(2)
      const tl3 = document.querySelector('.tl3');
      tl3.textContent = ''
      const tm3 = document.querySelector('.tm3');
      tm3.textContent = 'Aces per Service Game'
      const tr3 = document.querySelector('.tr3');
      tr3.textContent = ''
      const tl4 = document.querySelector('.tl4');
      tl4.textContent = ''
      const tm4 = document.querySelector('.tm4');
      tm4.textContent = 'Aces per Set'
      const tr4 = document.querySelector('.tr4');
      tr4.textContent = ''
      changeValue('t5', '', '', '')
      changeValue('t6', '', '', '')
      changeValue('t7', '', '', '')
      adfbfmiddle()
    }

    function adfbf() {
      statmode = 'Adf'
      changeTitles("Aces", "Double Faults", "Other")
      adfbfbottom()
      adfbftop()
    }

    function makeScore() {
      let scorestr = '';
      for (let i = 0; i < prevSets.length; i++) {
        scorestr += prevSets[i];
        scorestr += ", "
      }
      if (agames != '0' || bgames != '0') {
        scorestr += agames + '-' + bgames + ", "
      }
      scorestr += apts + '-' + bpts
      return scorestr
    }

    function makeStats(winner, event, fsin, ps) {

      let selections = [];
      if (document.querySelector('input[name="whocame"]:checked')) {
        let checked = document.querySelectorAll('input[name="whocame"]:checked');
        for (let i = 0; i < checked.length; i++) {
          selections.push(checked[i].value);
        }
      }
      if (selections.includes('Acame')) {
        PlayerA.inc("Net Points")
        if (winner === "Awon") {
          PlayerA.inc("Net Points Won")
        }
      }
      if (selections.includes('Bcame')) {
        PlayerB.inc("Net Points")
        if (winner === "Bwon") {
          PlayerB.inc("Net Points Won")
        }
      }
      if (ps === 'Player A') {
        if (fsin === 'servein') {
          PlayerA.inc("First Serve Points")
          if (winner === 'Awon') {
            PlayerA.inc("First Serve Points Won")
          }
        }
        else {
          PlayerA.inc("Second Serve Points")
          if (winner === 'Awon') {
            PlayerA.inc("Second Serve Points Won")
          }
        }
      }
      else {
        if (fsin === 'servein') {
          PlayerB.inc("First Serve Points")
          if (winner === 'Bwon') {
            PlayerB.inc("First Serve Points Won")
          }
        }
        else {
          PlayerB.inc("Second Serve Points")
          if (winner === 'Bwon') {
            PlayerB.inc("Second Serve Points Won")
          }
        }

      }
      if (winner === 'Awon') {
        PlayerA.inc("Points")
        switch (event) {
          case 'ace': PlayerA.inc("Aces"); break;
          case 'df': PlayerB.inc("Double Faults"); break;
        }
      } else if (winner === 'Bwon') {
        PlayerB.inc("Points")
        switch (event) {
          case 'ace': PlayerB.inc("Aces"); break;
          case 'df': PlayerA.inc("Double Faults"); break;
        }
      }

      switch (statmode) {
        case 'Total': totalbf(); break;
        case 'Overview': overviewbf(); break;
        case 'Wen': wenbf(); break;
        case 'Returning': returnbf(); break;
        case 'Adf': adfbf(); break;
        case 'Serving': servingbf(); break;
      }
    }
    function makePbp(winner, event) {
      const pbp = document.querySelector('.pbp');
      if (winner === 'Awon') {
        pbp.textContent += 'A won the point';
        pbp.textContent += '\n'
      } else if (winner === 'Bwon') {
        pbp.textContent += 'B won the point \n';
      }
    }

    function increment() {
      var div = document.querySelector(".score");
      let winner = document.querySelector('input[name="whowon"]:checked').value;
      var prevserver = server;

      if (isBreakPoint(server, apts, bpts)) {
        if (server === "Player A") {
          PlayerB.inc("Break Points")

          if (winner === 'Bwon') {
            PlayerB.inc("Break Points Won")
          }
        }
        if (server === 'Player B') {
          PlayerA.inc("Break Points")
          if (winner === 'Awon') {
            PlayerA.inc("Break Points Won")
          }
        }
      }

      if (winner === 'Awon') {
        if (tiebreak === 7) {
          apts++
          if (apts >= 7 && apts > bpts + 1) {
            agames++
            prevSets.push(agames + '-' + bgames + ' ' + '(' + bpts + ')')
            apts = 0
            bpts = 0
            agames = 0
            bgames = 0
            tiebreak = 0
            if (server === tbserver) {
              toggleServer()
            }
          }
          if ((apts + bpts) % 2 === 1) {
            toggleServer()
          }
        }
        else if (apts === 40 && bpts === 'AD') {
          bpts = 40
        }
        else if (apts === 40 && bpts === 40) {
          apts = 'AD'
        }
        else if (apts === 40 || apts === 'AD') {
          apts = 0;
          bpts = 0;
          agames++;
          toggleServer()
          PlayerA.inc("Games")
          if (agames === 6 && bgames < 5 || agames === 7) {
            prevSets.push(agames + '-' + bgames)
            agames = 0;
            bgames = 0;
          }
          else if (agames === 6 && bgames === 6) {
            tiebreak = 7
            tbserver = server;
          }
        }
        else {
          apts = gameScores[gameScores.indexOf(apts) + 1]
        }
      }
      else if (winner === 'Bwon') {
        if (tiebreak === 7) {
          bpts++
          if (bpts >= 7 && bpts > apts + 1) {
            bgames++
            prevSets.push(agames + '-' + bgames + ' ' + '(' + apts + ')')
            apts = 0
            bpts = 0
            agames = 0
            bgames = 0
            tiebreak = 0
            if (server === tbserver) {
              toggleServer()
            }
          }
          if ((apts + bpts) % 2 === 1) {
            toggleServer()
          }
        }
        else if (bpts === 40 && apts === 'AD') {
          apts = 40
        }
        else if (bpts === 40 && apts === 40) {
          bpts = 'AD'
        }
        else if (bpts === 40 || bpts === 'AD') {
          apts = 0;
          bpts = 0;
          PlayerB.inc("Games")
          bgames++;
          toggleServer()
          if (bgames === 6 && agames < 5 || bgames === 7) {
            prevSets.push(agames + '-' + bgames)
            bgames = 0;
            agames = 0;
          }
          else if (bgames === 6 && agames === 6) {
            tiebreak = 7
            tbserver = server;
          }
        } else {
          bpts = gameScores[gameScores.indexOf(bpts) + 1]
        }
      }
      else {
        return
      }

      const selection = document.querySelector('input[name="howwon"]:checked').value;
      const servein = document.querySelector('input[name="serveIn"]:checked').value;

      div.textContent = makeScore();
      makePbp(winner, 0)
      makeStats(winner, selection, servein, prevserver)
    }

  </script>
</body>

</html>